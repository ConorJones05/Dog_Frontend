{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/conor/dog-website/client/src/app/admin/page.tsx"],"sourcesContent":["'use client';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport axios from 'axios';\r\nimport { Bar } from 'react-chartjs-2';\r\nimport { \r\nChart as ChartJS, \r\nCategoryScale, \r\nLinearScale, \r\nBarElement, \r\nTitle, \r\nTooltip, \r\nLegend \r\n} from 'chart.js';\r\n\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport axios from 'axios';\r\nChartJS.register(\r\nCategoryScale,\r\nLinearScale,\r\nBarElement,\r\nTitle,\r\nTooltip,\r\nLegend\r\n);\r\n\r\ninterface DashboardStatistics {\r\ntotal_dogs: number;\r\nunique_breeds: number;\r\nbreed_distribution: Record<string, number>;\r\ntotal_inventory_value: number;\r\naverage_price: number;\r\n}\r\n\r\ninterface DashboardResponse {\r\nstatistics: DashboardStatistics;\r\ndogs: Dog[];\r\n}\r\n\r\ninterface Dog {\r\n  id: string;\r\n  name: string;\r\n  image: string;\r\n  breed: string;\r\n  price: number;\r\n}\r\n\r\nconst AdminPage = () => {\r\n  const router = useRouter();\r\n  const [dogs, setDogs] = useState<Dog[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [editingDog, setEditingDog] = useState<Dog | null>(null);\r\n  const [newDog, setNewDog] = useState({ name: '', image: '', breed: '', price: 0 });\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n\r\n  const getToken = () => {\r\n    if (typeof window !== 'undefined') {\r\n      const session = localStorage.getItem('session');\r\n      if (session) {\r\n        try {\r\n          return JSON.parse(session).access_token;\r\n        } catch (e) {\r\n          console.error('Error parsing session from localStorage', e);\r\n          localStorage.removeItem('session');\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const fetchDogs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = getToken();\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.get('http://localhost:5000/admin/dashboard', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      setDogs(response.data.dogs);\r\n      setLoading(false);\r\n    } catch (err: any) {\r\n      console.error('Error fetching dogs:', err);\r\n      if (err.response && err.response.status === 403) {\r\n        setError('Unauthorized. Please log in again.');\r\n        localStorage.removeItem('session');\r\n        setTimeout(() => router.push('/login'), 2000);\r\n      } else {\r\n        setError('Failed to fetch dogs. Please try again.');\r\n      }\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDogs();\r\n  }, []);\r\n  \r\n  const handleAddDog = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      const token = getToken();\r\n      await axios.post('http://localhost:5000/admin', newDog, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setNewDog({ name: '', image: '', breed: '', price: 0 });\r\n      setShowAddForm(false);\r\n      fetchDogs();\r\n    } catch (err) {\r\n      setError('Failed to add dog. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleUpdateDog = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!editingDog) return;\r\n    try {\r\n      const token = getToken();\r\n      await axios.put('http://localhost:5000/admin', editingDog, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setEditingDog(null);\r\n      fetchDogs();\r\n    } catch (err) {\r\n      setError('Failed to update dog. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleDeleteDog = async (id: string) => {\r\n    if (!window.confirm('Are you sure you want to delete this dog?')) return;\r\n    try {\r\n      const token = getToken();\r\n      await axios.delete('http://localhost:5000/admin', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        data: { id }\r\n      });\r\n      fetchDogs();\r\n    } catch (err) {\r\n      setError('Failed to delete dog. Please try again.');\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className=\"flex justify-center p-8\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Admin Dashboard - Dog Management</h1>\r\n      {error && <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">{error}</div>}\r\n      <button\r\n        className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded mb-4\"\r\n        onClick={() => setShowAddForm(prev => !prev)}\r\n      >\r\n        {showAddForm ? 'Cancel' : 'Add New Dog'}\r\n      </button>\r\n      {showAddForm && (\r\n        <form onSubmit={handleAddDog} className=\"mb-6 p-4 border rounded\">\r\n        </form>\r\n      )}\r\n      {editingDog && (\r\n        <form onSubmit={handleUpdateDog} className=\"mb-6 p-4 border rounded\">\r\n        </form>\r\n      )}\r\n      <div className=\"overflow-x-auto\">\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminPage;\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}